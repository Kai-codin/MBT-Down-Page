<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checking Site Status</title>
    <script>
        // Function to check if the main site is up
        async function checkMainSite(url) {
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 5000); // 5-second timeout

                const response = await fetch('https://www1.mybustimes.cc', {
                    method: 'HEAD',
                    mode: 'no-cors',
                    signal: controller.signal
                });

                clearTimeout(timeoutId);

                if (response.type === 'opaque') {
                    // If the main site is up, redirect to the target URL
                    window.location.href = url;
                } else {
                    // If the main site is not up, show an error message
                    document.getElementById('status').innerText = 'The main site is down. Please try again later.';
                }
            } catch (error) {
                // On error (e.g., timeout), show an error message
                document.getElementById('status').innerText = 'Error: The main site is not reachable. Please try again later.';
            }
        }

        // Call the check function when the page loads
        window.onload = function() {
            const url = new URLSearchParams(window.location.search).get('url');
            if (url) {
                checkMainSite(url);
            }
        }
    </script>
</head>
<body>
</body>
</html>
